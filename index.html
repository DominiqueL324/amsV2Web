<!DOCTYPE html>
<html lang="en" style="height: auto">

<head>
    <meta charset="utf-8" />
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <meta name="description" content="Web site created using create-react-app" />
    <link rel="stylesheet" href="./assets/dist/css/parsley.css" />
    <link rel="shortcut icon" href="./assets/brand/logo.png" type="image/x-icon">
    <!-- <scriptsal
      src="https://code.jquery.com/jquery-3.6.0.js"
      integrity="sha256-H+K7U5CnXl1h5ywQfKtSj8PCmoN9aaq30gDh27Xc0jk="
      crossorigin="anonymous"
    ></script> -->
    <script src="./assets/plugins/jquery/jquery.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="./assets/dist/js/jquery-cookie-master/src/jquery.cookie.js"></script>
    <script src="./assets/dist/js/login.js"></script>
    <script src="./assets/dist/js/adminlte.js"></script>
    <script type="text/javascript" src="https://unpkg.com/validator.tool/dist/validator.min.js"></script>
    <title>Amexpert - AMS V2A</title>
    <!-- <script defer="defer" src="/static/js/main.069f0b50.js"></script> -->
    <link href="./assets/dist/css/adminlte.css" rel="stylesheet" />
    <link rel="stylesheet" type="text/css" href="assets/plugins/fontawesome-free/css/all.min.css" />
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.9.1/font/bootstrap-icons.css">
    <style data-styled="" data-styled-version="5.3.5"></style>
    <!-- <link rel="stylesheet" type="text/css" href="/static/css/282.e4ab9df4.chunk.css" /> -->
    <link href='./assets/plugins/fullcalendar/main.css' rel='stylesheet' />
    <link href="./assets/dist/css/virtual-select.min.css" rel="stylesheet" />
    <script src='./assets/plugins/fullcalendar/main.js'></script>
    <script src='./assets/plugins/fullcalendar/locales-all.js'></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM"
        crossorigin="anonymous"></script>
    <link href="./assets/dist/css/spinner.css" rel="stylesheet" />
    <script src="./assets/dist/js/jquery-cookie-master/jquery.toaster.js" type="text/javascript"></script>
    <script src="./assets/dist/js/virtual-select.min.js"></script>
    <script src="./assets/dist/js/inputValidator.js"></script>
    <script src="./assets/dist/js/validationTextMessage.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.13/css/select2.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.13/js/select2.min.js"></script>

    <!-- <script src="https://cdn.syncfusion.com/ej2/21.2.3/dist/ej2.min.js" type="text/javascript"></script> -->
</head>

<body classname="hold-transition sidebar-mini layout-navbar-fixed" style="height: auto">
    <noscript>You need to enable JavaScript to run this app.</noscript>
    <div id="root">
        <div class="wrapper">
            <nav class="main-header navbar navbar-expand navbar-white navbar-light relative" id="main-navbar">
                <!-- header -->
                <img src="./assets/brand/logo.png" alt="Logo"
                    style="position: absolute;left: 50%;top: 20px;transform: translate(-50%, 0%);" />
                <ul class="navbar-nav">
                    <li class="nav-item">
                        <a class="nav-link" data-widget="pushmenu" role="button" href="/"><i
                                class="fas fa-bars"></i></a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" onclick="window.history.go(-1);" title="Page précedente" role="button"
                            style="cursor: pointer;"><i class="bi bi-arrow-left"></i></a>
                    </li>
                </ul>
                <ul class="navbar-nav ml-auto">
                    <li class="nav-item">
                        <a class="nav-link text-decoration-underline" data-widget="control-sidebar" data-slide="true"
                            role="button" href id="logout" style="color: red">Déconnexion</a>
                    </li>
                </ul>
            </nav>
            <aside class="main-sidebar sidebar-dark-primary elevation-4" id="aside-navbar">
                <!-- aside bar -->
                <a class="brand-link" href="./index.html" style="display: block; text-align: center; margin: auto"><span
                        class="brand-text">AMS V2</span></a>
                <div
                    class="sidebar os-host os-theme-light os-host-overflow os-host-overflow-y os-host-resize-disabled os-host-scrollbar-horizontal-hidden os-host-transition">
                    <div class="os-resize-observer-host observed">
                        <div class="os-resize-observer" style="left: 0px; right: auto"></div>
                    </div>
                    <div class="os-size-auto-observer observed" style="height: calc(100% + 1px); float: left">
                        <div class="os-resize-observer"></div>
                    </div>
                    <div class="os-content-glue"></div>
                    <div class="os-padding">
                        <div class="os-viewport os-viewport-native-scrollbars-invisible">
                            <div class="os-content" style="height: 100%; width: 100%">
                                <div class="user-panel mt-1 pb-1 mb-3 d-flex justify-content-center align-items-center">
                                    <div class="info">
                                        <a class="d-block text-decoration-underline" href="./pages/profil/index.html"
                                            id="name_user" style="display: inline;"></a>
                                    </div>
                                </div>
                                <nav class="mt-2" style="overflow-y: scroll;max-height: 590px;">
                                    <ul class="nav nav-pills nav-sidebar flex-column" data-widget="treeview" role="menu"
                                        data-accordion="false">
                                        <li class="nav-item agentsecteur administrateur agentconstat">
                                            <a class="nav-link" href="index.html">
                                                <i class="bi bi-speedometer2"></i>
                                                <p>Tableau de Bord</p>
                                            </a>
                                        </li>

                                        <li class="nav-item agentsecteur administrateur" id="hide">
                                            <a class="nav-link" href="./pages/rdv/index.html">
                                                <i class="bi bi-calendar-day-fill"></i>
                                                <p>RDV</p>
                                            </a>
                                        </li>

                                        <li class="sub-menu nav-item agentsecteur " id="hide">
                                            <a class="nav-link sub-menu" href="#">
                                                <i class="bi bi-people"></i>
                                                <p>Participants</p>
                                                <i class="fas fa-angle-left right"></i>
                                            </a>
                                            <ul class="nav nav-treeview">
                                                <li class="nav-item" id="add_user_link">
                                                    <a class="nav-link" href="./pages/participants/ajouter.html"><i
                                                            class="bi bi-person-plus"></i>
                                                        <p>Ajouter un participant</p>
                                                    </a>
                                                </li>
                                                <li class="nav-item">
                                                    <a class="nav-link nav-item" href="./pages/participants/index.html"
                                                        list.html><i class="bi bi-list-columns-reverse"></i>
                                                        <p>Liste des participants</p>
                                                    </a>
                                                </li>
                                            </ul>
                                        </li>

                                        <li class="sub-menu nav-item" id="hide">
                                            <a class="nav-link sub-menu" href="#"><i class="bi bi-people"></i>
                                                <p>Compte Client</p>
                                                <i class="fas fa-angle-left right"></i>
                                            </a>
                                            <ul class="nav nav-treeview">
                                                <li class="nav-item" id="add_user_link">
                                                    <a class="nav-link" href="./pages/compteClient/ajouter.html"><i
                                                            class="bi bi-person-plus"></i></i>
                                                        <p>Ajouter un compte client</p>
                                                    </a>
                                                </li>
                                                <li class="nav-item">
                                                    <a class="nav-link" href="./pages/compteClient/index.html"><i
                                                            class="bi bi-list-columns-reverse"></i>
                                                        <p>Liste des compte client</p>
                                                    </a>
                                                </li>
                                            </ul>
                                        </li>

                                        <li class="sub-menu nav-item agentsecteur " id="hide">
                                            <a class="nav-link sub-menu" href="#"><i class="bi bi-house"></i>
                                                <p>Logement</p>
                                                <i class="fas fa-angle-left right"></i>
                                            </a>
                                            <ul class="nav nav-treeview">
                                                <li class="nav-item">
                                                    <a class="nav-link nav-item" href="./pages/logements/ajouter.html">
                                                        <i class="bi bi-house-add"></i>
                                                        <p>Ajouter un Logement</p>
                                                    </a>
                                                </li>
                                                <li class="nav-item">
                                                    <a class="nav-link" href="./pages/logements/index.html">
                                                        <i class="bi bi-houses"></i>
                                                        <p>Liste de Logements</p>
                                                    </a>
                                                </li>
                                            </ul>
                                        </li>

                                        <li class="nav-item agentsecteur agentconstat" id="hide">
                                            <a class="nav-link" href="./pages/constats/index.html"><i
                                                    class="bi bi-list-columns-reverse"></i>
                                                <p>Constats</p>
                                            </a>
                                        </li>


                                        <!-- <li class="nav-item administrateur" id="hide">
                                        <a class="nav-link" href="#/importBiliotheque/index.html"><i class="bi bi-cloud-arrow-up"></i>
                                            <p>Import des bibliothèque</p>
                                        </a>
                                    </li> -->

                                        <li class="sub-menu nav-item agentsecteur administrateur" id="hide">
                                            <a class="nav-link sub-menu" href="#"><i class="bi bi-house"></i>
                                                <p>Bibliothèque Logement</p>
                                                <i class="fas fa-angle-left right"></i>
                                            </a>
                                            <ul class="nav nav-treeview">
                                                <li class="nav-item">
                                                    <a class="nav-link nav-item"
                                                        href="./pages/bibliothequeLogement/extension/index.html">
                                                        <i class="bi bi-house-add"></i>
                                                        <p>Extension</p>
                                                    </a>
                                                </li>
                                                <li class="nav-item">
                                                    <a class="nav-link nav-item"
                                                        href="pages/bibliothequeLogement/voie/index.html">
                                                        <i class="bi bi-house-add"></i>
                                                        <p>Voies</p>
                                                    </a>
                                                </li>
                                                <li class="nav-item">
                                                    <a class="nav-link"
                                                        href="pages/bibliothequeLogement/cles/index.html">
                                                        <i class="bi bi-houses"></i>
                                                        <p>Clés</p>
                                                    </a>
                                                </li>
                                                <li class="nav-item">
                                                    <a class="nav-link"
                                                        href="pages/bibliothequeLogement/compteur/index.html">
                                                        <i class="bi bi-houses"></i>
                                                        <p>Compteurs</p>
                                                    </a>
                                                </li>
                                                <li class="nav-item">
                                                    <a class="nav-link"
                                                        href="pages/bibliothequeLogement/rubrique/index.html">
                                                        <i class="bi bi-houses"></i>
                                                        <p>Rubriques</p>
                                                    </a>
                                                </li>
                                                <li class="nav-item">
                                                    <a class="nav-link"
                                                        href="pages/bibliothequeLogement/piece/index.html">
                                                        <i class="bi bi-houses"></i>
                                                        <p>Pièces</p>
                                                    </a>
                                                </li>
                                                <li class="nav-item">
                                                    <a class="nav-link"
                                                        href="pages/bibliothequeLogement/logements/index.html">
                                                        <i class="bi bi-houses"></i>
                                                        <p>Logements</p>
                                                    </a>
                                                </li>
                                            </ul>
                                        </li>

                                        <li class="sub-menu nav-item administrateur" id="hide">
                                            <a class="nav-link sub-menu" href="#"><i class="bi bi-house"></i>
                                                <p>Bibliothèque Commentaire</p>
                                                <i class="fas fa-angle-left right"></i>
                                            </a>
                                            <ul class="nav nav-treeview">
                                                <li class="nav-item">
                                                    <a class="nav-link nav-item"
                                                        href="pages/bibliothequeCommentaire/cles/index.html">
                                                        <i class="bi bi-house-add"></i>
                                                        <p>Clés</p>
                                                    </a>
                                                </li>
                                                <li class="nav-item">
                                                    <a class="nav-link"
                                                        href="pages/bibliothequeCommentaire/compteur/index.html">
                                                        <i class="bi bi-houses"></i>
                                                        <p>Compteurs</p>
                                                    </a>
                                                </li>
                                                <li class="nav-item">
                                                    <a class="nav-link"
                                                        href="pages/bibliothequeCommentaire/rubrique/index.html">
                                                        <i class="bi bi-houses"></i>
                                                        <p>Rubriques</p>
                                                    </a>
                                                </li>
                                                <li class="nav-item">
                                                    <a class="nav-link"
                                                        href="pages/bibliothequeCommentaire/commentaire/index.html">
                                                        <i class="bi bi-houses"></i>
                                                        <p>Autres Commentaires</p>
                                                    </a>
                                                </li>
                                            </ul>
                                        </li>
                                    </ul>
                                </nav>
                            </div>
                        </div>
                    </div>
                    <div class="os-scrollbar os-scrollbar-horizontal os-scrollbar-unusable os-scrollbar-auto-hidden">
                        <div class="os-scrollbar-track">
                            <div class="os-scrollbar-handle" style="width: 100%; transform: translate(0px, 0px)"></div>
                        </div>
                    </div>
                    <div class="os-scrollbar os-scrollbar-vertical os-scrollbar-auto-hidden">
                        <div class="os-scrollbar-track">
                            <div class="os-scrollbar-handle" style="height: 31.7881%; transform: translate(0px, 0px)">
                            </div>
                        </div>
                    </div>
                    <div class="os-scrollbar-corner"></div>
                </div>

            </aside>
            <div class="content-wrapper" style="min-height: 748px" id="main-content">

                <div class="content-header">
                    <div class="container-fluid">
                        <div class="row mb-2">
                            <div class="col-sm-6">
                                <h1 class="m-0">Tableau de bord</h1>
                            </div>
                            <div class="col-sm-6">
                                <ol class="breadcrumb float-sm-right">
                                    <li class="breadcrumb-item ">
                                    </li>
                                </ol>
                            </div>
                        </div>
                    </div>
                </div>
                <section class="content">
                    <div class="container-fluid">
                        <div class="row">
                            <div class="col hide administrateur" id="user_box">
                                <div class="small-box bg-1" style="position: relative">
                                    <div class="inner">
                                        <h3 id="nombre_user">713</h3>
                                        <p>
                                            <a href="#" style="color: black">UTILISATEURS</a>
                                        </p>
                                    </div>
                                    <div class="icon"><i class="fas fa-users"></i></div>
                                    <span class="small-box-footer cursor" type="button" data-bs-toggle="dropdown"
                                        aria-expanded="false"></span>
                                </div>
                            </div>
                            <div class="col hide administrateur" id="admin_box">
                                <div class="small-box bg-3" style="position: relative">
                                    <div class="inner">
                                        <h3 id="nombre_admin">36</h3>
                                        <p>
                                            <a href="#" style="color: white">ADMINISTRATEUR</a>
                                        </p>
                                    </div>
                                    <div class="icon"><i class="fas fa-users"></i></div>
                                    <span class="small-box-footer cursor" type="button" data-bs-toggle="dropdown"
                                        aria-expanded="false"></span>
                                </div>
                            </div>
                            <div class="col hide administrateur agentsecteur" id="agent_box">
                                <div class="small-box bg-4" style="position: relative">
                                    <div class="inner">
                                        <h3 id="nombre_agent">36</h3>
                                        <p>
                                            <a href="#" style="color: white">AGENT</a>
                                        </p>
                                    </div>
                                    <div class="icon"><i class="fas fa-users"></i></div>
                                    <span class="small-box-footer cursor" type="button" data-bs-toggle="dropdown"
                                        aria-expanded="false"></span>
                                </div>
                            </div>
                            <div class="col hide administrateur agentsecteur" id="client_box">
                                <div class="small-box bg-5" style="position: relative">
                                    <div class="inner">
                                        <h3 id="nombre_client">372</h3>
                                        <p>
                                            <a href="#" style="color: white">CLIENT</a>
                                        </p>
                                    </div>
                                    <div class="icon"><i class="fas fa-users"></i></div>
                                    <span class="small-box-footer cursor" type="button" data-bs-toggle="dropdown"
                                        aria-expanded="false"></span>
                                </div>
                            </div>

                            <div class="col hide administrateur agentsecteur" id="rdv_box">
                                <div class="small-box bg-2">
                                    <div class="inner">
                                        <h3 id="rdv_salarie">4</h3>
                                        <p>
                                            <a href="#" style="color: white">SALARIE</a>
                                        </p>
                                    </div>
                                    <div class="icon"><i class="ion ion-stats-bars"></i></div>
                                    <span class="small-box-footer cursor"></span>
                                </div>
                            </div>
                            <div class="col hide administrateur agentsecteur" id="rdv_valide_box">
                                <div class="small-box bg-2">
                                    <div class="inner">
                                        <h3 id="nombre_rdv">4</h3>
                                        <p>
                                            <a href="#" style="color: white">RENDEZ-VOUS</a>
                                        </p>
                                    </div>
                                    <div class="icon"><i class="ion ion-stats-bars"></i></div>
                                    <span class="small-box-footer cursor"></span>
                                </div>
                            </div>
                        </div>
                        <!-- <div class="row" style="display: inline;" id="waiters"></div> -->
                        <div class="row">
                            <div class="col">
                                <div class="card" style="padding: 15;">
                                    <div class="card-header">
                                        <div class="row">
                                            <div class="col-8">
                                                <H2> EDL par an</H2>
                                            </div>
                                            <div class="col">
                                                <select class="form-control" type="date" name="" id="years">
                                                    <option value="0">--Tout--</option>
                                                </select>
                                            </div>
                                        </div>
                                    </div>
                                    <div id="chart_div">
                                        <canvas id='myChart'></canvas>
                                    </div>
                                </div>
                            </div>
                            <div class="col">
                                <div class="card" style="padding: 15;">
                                    <div class="card-header">
                                        <div class="row">
                                            <H2>Calendrier des RDV</H2>
                                        </div>
                                    </div>
                                    <div id='calendar'></div>
                                </div>
                            </div>
                        </div>

                    </div>
                </section>


            </div>
            <footer class="main-footer"
                style="max-height: 57px; height: 57px; display: flex; justify-content: space-between;">
                <p><b>Version</b> 2.0.0 <strong>
                        Tous droits réservés. © <span id="copyright_year"></span>
                    </strong></p>
                <a href="https://amexpert.pro/" rel="noopener noreferrer" target="_blank"
                    style="color: black"><b>AMEXPERT</b></a>
            </footer>
        </div>
    </div>
    <script src="./assets/dist/js/dashboard.js"></script>
    <script src="./assets/dist/js/pageLoader.js" async></script>


    <script type="text/javascript">
       
        function loadChart(year = 0) {
            data = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
            const config = {
                type: 'line',
                data: {
                    labels: ['Janvier', 'Février', 'Mars', 'Avril', 'Mai', 'Juin', 'Juillet', 'Aout', 'Sept', 'Oct', 'Nov', 'Dec'],
                    datasets: [{
                        label: 'nombre d\'EDL',
                        data: data,
                        fill: false,
                        borderColor: 'rgb(75, 190, 190)',
                    }]
                },
                options: {
                    transitions: {
                        show: {
                            animations: {
                                x: {
                                    from: 0
                                },
                                y: {
                                    from: 0
                                }
                            }
                        },
                        hide: {
                            animations: {
                                x: {
                                    to: 0
                                },
                                y: {
                                    to: 0
                                }
                            }
                        }
                    }
                }
            }
            let url = "";
            // if (localStorage.getItem('group') === "Agent secteur") {
            //     url = "http://195.15.218.172/edlgateway/api/v1/planif/edl/part/?ID=" + localStorage.getItem("id_user_logged")
            // } else {
            //     url = "http://195.15.218.172/edlgateway/api/v1/planif/edl/all?start=1&limit=10&count=10"
            // }
            url = 'http://195.15.218.172/rdv_app/rdv/?en_charge=1';
            $.ajax({
                method: "GET",
                url: url,
                headers: {
                    Authorization: "Bearer " + localStorage.getItem("token")
                },
                success: (response) => {
                    $("#chart_div").html("")
                    $('#chart_div').append("<canvas id='myChart'></canvas>")
                    const ctx = document.getElementById('myChart');
                    var myChart = new Chart(ctx, config);
                    if (parseInt($("#years").val()) === 0) {
                        response.results.forEach((element) => {
                            console.log(element);
                            let month = parseInt(element['date'].split('-')[1])
                            data[month - 1] = data[month - 1] + 1
                        });
                    } else {
                        let y = response.results.filter((element) => {
                            return parseInt($("#years").val()) === parseInt(element['date_edl'].split('-')[0])
                        });

                        y.forEach((element) => {
                            let month = parseInt(element['date_edl'].split('-')[1])
                            data[month - 1] = data[month - 1] + 1
                        });
                    }

                    config.datasets = [{
                        label: 'nombre d\'EDL',
                        data: data,
                        fill: false,
                        borderColor: 'rgb(75, 190, 190)',
                    }]
                    //var myChart=new Chart(ctx, config );
                },
                error: () => { }
            });
        }

        loadChart();
        let oday = new Date().getFullYear()
        for (i = 2000; i <= oday; i++) {
            $('#years').append('<option value="' + i + '">' + i + '</option>')
        }

        $('#years').on('change', function (e) {
            loadChart(parseInt($('#years').val()));
        });

        configCal();
    </script>

</body>

</html>