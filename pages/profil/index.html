<!DOCTYPE html>
<html lang="en" style="height: auto">

<head>
    <meta charset="utf-8" />
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <meta name="description" content="Web site created using create-react-app" />
    <link rel="stylesheet" href="./../../assets/dist/css/parsley.css" />
    <!--<scriptsal
      src="https://code.jquery.com/jquery-3.6.0.js"
      integrity="sha256-H+K7U5CnXl1h5ywQfKtSj8PCmoN9aaq30gDh27Xc0jk="
      crossorigin="anonymous"
    ></script>-->
    <script src="./../../assets/plugins/jquery/jquery.min.js"></script>
    <script src="./../../assets/dist/js/jquery-cookie-master/src/jquery.cookie.js"></script>
    <script src="./../../assets/dist/js/login.js"></script>
    <script src="./../../assets/dist/js/adminlte.js"></script>
    <script type="text/javascript" src="https://unpkg.com/validator.tool/dist/validator.min.js"></script>
    <title>Amexpert - AMS V2</title>
    <!-- <script defer="defer" src="/static/js/main.069f0b50.js"></script> -->
    <link href="./../../assets/dist/css/adminlte.css" rel="stylesheet" />
    <link rel="stylesheet" type="text/css" href="./../../assets/plugins/fontawesome-free/css/all.min.css" />
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.9.1/font/bootstrap-icons.css">
    <style data-styled="" data-styled-version="5.3.5"></style>
    <!-- <link rel="stylesheet" type="text/css" href="/static/css/282.e4ab9df4.chunk.css" /> -->
    <link href='./../../assets/plugins/fullcalendar/main.css' rel='stylesheet' />
    <link href="./../../assets/dist/css/virtual-select.min.css" rel="stylesheet" />
    <link rel="shortcut icon" href="./../../assets/brand/logo.png" type="image/x-icon">
    <script src='./../../assets/plugins/fullcalendar/main.js'></script>
    <script src='./../../assets/plugins/fullcalendar/locales-all.js'></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM"
        crossorigin="anonymous"></script>
    <link href="./../../assets/dist/css/spinner.css" rel="stylesheet" />
    <script src="./../../assets/dist/js/jquery-cookie-master/jquery.toaster.js" type="text/javascript"></script>
   
    <script src="./../../assets/dist/js/virtual-select.min.js"></script>
    <script src="./../../assets/dist/js/inputValidator.js"></script>
    <script src="./../../assets/dist/js/validationTextMessage.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.13/css/select2.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.13/js/select2.min.js"></script>

    <script src="https://cdn.syncfusion.com/ej2/21.2.3/dist/ej2.min.js" type="text/javascript"></script>
</head>

<body classname="hold-transition sidebar-mini layout-navbar-fixed" style="height: auto">
    <noscript>You need to enable JavaScript to run this app.</noscript>
    <div id="root">
        <div class="wrapper">
            <nav class="main-header navbar navbar-expand navbar-white navbar-light relative" id="main-navbar">
                <!-- header -->
                <img src="./../../assets/brand/logo.png" alt="Logo"
                    style="position: absolute;left: 50%;top: 20px;transform: translate(-50%, 0%);" />
                <ul class="navbar-nav">
                    <li class="nav-item">
                        <a class="nav-link" data-widget="pushmenu" role="button" href="/"><i
                                class="fas fa-bars"></i></a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" onclick="window.history.go(-1);" title="Page précedente"
                            role="button" style="cursor: pointer;"><i class="bi bi-arrow-left"></i></a>
                    </li>
                </ul>
                <ul class="navbar-nav ml-auto">
                    <li class="nav-item">
                        <a class="nav-link text-decoration-underline" data-widget="control-sidebar" data-slide="true"
                            role="button" href id="logout" style="color: red">Déconnexion</a>
                    </li>
                </ul>
            </nav>
            <aside class="main-sidebar sidebar-dark-primary elevation-4" id="aside-navbar">
                <!-- aside bar -->
                <a class="brand-link" href="../../index.html"
                    style="display: block; text-align: center; margin: auto"><span class="brand-text">AMS V2</span></a>
                <div
                    class="sidebar os-host os-theme-light os-host-overflow os-host-overflow-y os-host-resize-disabled os-host-scrollbar-horizontal-hidden os-host-transition">
                    <div class="os-resize-observer-host observed">
                        <div class="os-resize-observer" style="left: 0px; right: auto"></div>
                    </div>
                    <div class="os-size-auto-observer observed" style="height: calc(100% + 1px); float: left">
                        <div class="os-resize-observer"></div>
                    </div>
                    <div class="os-content-glue"></div>
                    <div class="os-padding">
                        <div class="os-viewport os-viewport-native-scrollbars-invisible">
                            <div class="os-content" style="height: 100%; width: 100%">
                                <div class="user-panel mt-1 pb-1 mb-3 d-flex justify-content-center align-items-center">
                                    <div class="info">
                                        <a class="d-block text-decoration-underline" href="../profil/index.html"
                                            id="name_user" style="display: inline;"></a>
                                    </div>
                                </div>
                                <nav class="mt-2" style="overflow-y: scroll;max-height: 590px;">
                                    <ul class="nav nav-pills nav-sidebar flex-column" data-widget="treeview" role="menu"
                                        data-accordion="false">
                                        <li class="nav-item agentsecteur administrateur agentconstat">
                                            <a class="nav-link" href="../../index.html">
                                                <i class="bi bi-speedometer2"></i>
                                                <p>Tableau de Bord</p>
                                            </a>
                                        </li>

                                        <li class="sub-menu nav-item agentsecteur " id="hide">
                                            <a class="nav-link sub-menu" href="#">
                                                <i class="bi bi-people"></i>
                                                <p>Participants</p>
                                                <i class="fas fa-angle-left right"></i>
                                            </a>
                                            <ul class="nav nav-treeview">
                                                <li class="nav-item" id="add_user_link">
                                                    <a class="nav-link" href="../participants/ajouter.html"><i
                                                            class="bi bi-person-plus"></i>
                                                        <p>Ajouter un participant</p>
                                                    </a>
                                                </li>
                                                <li class="nav-item">
                                                    <a class="nav-link nav-item" href="../participants/index.html"
                                                        list.html><i class="bi bi-list-columns-reverse"></i>
                                                        <p>Liste des participants</p>
                                                    </a>
                                                </li>
                                            </ul>
                                        </li>

                                        <li class="sub-menu nav-item " id="hide">
                                            <a class="nav-link sub-menu" href="#"><i class="bi bi-people"></i>
                                                <p>Compte Client</p>
                                                <i class="fas fa-angle-left right"></i>
                                            </a>
                                            <ul class="nav nav-treeview">
                                                <li class="nav-item" id="add_user_link">
                                                    <a class="nav-link" href="../compteClient/ajouter.html"><i
                                                            class="bi bi-person-plus"></i></i>
                                                        <p>Ajouter un compte client</p>
                                                    </a>
                                                </li>
                                                <li class="nav-item">
                                                    <a class="nav-link" href="../compteClient/index.html"><i
                                                            class="bi bi-list-columns-reverse"></i>
                                                        <p>Liste des compte client</p>
                                                    </a>
                                                </li>
                                            </ul>
                                        </li>

                                        <li class="sub-menu nav-item agentsecteur" id="hide">
                                            <a class="nav-link sub-menu" href="#"><i class="bi bi-house"></i>
                                                <p>Logement</p>
                                                <i class="fas fa-angle-left right"></i>
                                            </a>
                                            <ul class="nav nav-treeview">
                                                <li class="nav-item">
                                                    <a class="nav-link nav-item" href="../logements/ajouter.html">
                                                        <i class="bi bi-house-add"></i>
                                                        <p>Ajouter un Logement</p>
                                                    </a>
                                                </li>
                                                <li class="nav-item">
                                                    <a class="nav-link" href="../logements/index.html">
                                                        <i class="bi bi-houses"></i>
                                                        <p>Liste de Logements</p>
                                                    </a>
                                                </li>
                                            </ul>
                                        </li>

                                        <li class="nav-item agentsecteur agentconstat" id="hide">
                                            <a class="nav-link" href="../constats/index.html"><i
                                                    class="bi bi-list-columns-reverse"></i>
                                                <p>Constats</p>
                                            </a>
                                        </li>

                                        <li class="sub-menu nav-item agentsecteur administrateur" id="hide">
                                            <a class="nav-link sub-menu" href="#"><i class="bi bi-house"></i>
                                                <p>Bibliothèque Logement</p>
                                                <i class="fas fa-angle-left right"></i>
                                            </a>
                                            <ul class="nav nav-treeview">
                                                <li class="nav-item">
                                                    <a class="nav-link nav-item"
                                                        href="../bibliothequeLogement/extension/index.html">
                                                        <i class="bi bi-house-add"></i>
                                                        <p>Extension</p>
                                                    </a>
                                                </li>
                                                <li class="nav-item">
                                                    <a class="nav-link nav-item"
                                                        href="../bibliothequeLogement/voie/index.html">
                                                        <i class="bi bi-house-add"></i>
                                                        <p>Voies</p>
                                                    </a>
                                                </li>
                                                <li class="nav-item">
                                                    <a class="nav-link" href="../bibliothequeLogement/cles/index.html">
                                                        <i class="bi bi-houses"></i>
                                                        <p>Clés</p>
                                                    </a>
                                                </li>
                                                <li class="nav-item">
                                                    <a class="nav-link"
                                                        href="../bibliothequeLogement/compteur/index.html">
                                                        <i class="bi bi-houses"></i>
                                                        <p>Compteurs</p>
                                                    </a>
                                                </li>
                                                <li class="nav-item">
                                                    <a class="nav-link"
                                                        href="../bibliothequeLogement/rubrique/index.html">
                                                        <i class="bi bi-houses"></i>
                                                        <p>Rubriques</p>
                                                    </a>
                                                </li>
                                                <li class="nav-item">
                                                    <a class="nav-link" href="../bibliothequeLogement/piece/index.html">
                                                        <i class="bi bi-houses"></i>
                                                        <p>Pièces</p>
                                                    </a>
                                                </li>
                                                <li class="nav-item">
                                                    <a class="nav-link"
                                                        href="../bibliothequeLogement/logements/index.html">
                                                        <i class="bi bi-houses"></i>
                                                        <p>Logements</p>
                                                    </a>
                                                </li>
                                            </ul>
                                        </li>

                                        <li class="sub-menu nav-item administrateur" id="hide">
                                            <a class="nav-link sub-menu" href="#"><i class="bi bi-house"></i>
                                                <p>Bibliothèque Commentaire</p>
                                                <i class="fas fa-angle-left right"></i>
                                            </a>
                                            <ul class="nav nav-treeview">
                                                <li class="nav-item">
                                                    <a class="nav-link nav-item"
                                                        href="../bibliothequeCommentaire/cles/index.html">
                                                        <i class="bi bi-house-add"></i>
                                                        <p>Clés</p>
                                                    </a>
                                                </li>
                                                <li class="nav-item">
                                                    <a class="nav-link"
                                                        href="../bibliothequeCommentaire/compteur/index.html">
                                                        <i class="bi bi-houses"></i>
                                                        <p>Compteurs</p>
                                                    </a>
                                                </li>
                                                <li class="nav-item">
                                                    <a class="nav-link"
                                                        href="../bibliothequeCommentaire/rubrique/index.html">
                                                        <i class="bi bi-houses"></i>
                                                        <p>Rubriques</p>
                                                    </a>
                                                </li>
                                                <li class="nav-item">
                                                    <a class="nav-link"
                                                        href="../bibliothequeCommentaire/commentaire/index.html">
                                                        <i class="bi bi-houses"></i>
                                                        <p>Autres Commentaires</p>
                                                    </a>
                                                </li>
                                            </ul>
                                        </li>
                                    </ul>
                                </nav>
                            </div>
                        </div>
                    </div>
                    <div class="os-scrollbar os-scrollbar-horizontal os-scrollbar-unusable os-scrollbar-auto-hidden">
                        <div class="os-scrollbar-track">
                            <div class="os-scrollbar-handle" style="width: 100%; transform: translate(0px, 0px)"></div>
                        </div>
                    </div>
                    <div class="os-scrollbar os-scrollbar-vertical os-scrollbar-auto-hidden">
                        <div class="os-scrollbar-track">
                            <div class="os-scrollbar-handle" style="height: 31.7881%; transform: translate(0px, 0px)">
                            </div>
                        </div>
                    </div>
                    <div class="os-scrollbar-corner"></div>
                </div>
            </aside>
            <div class="content-wrapper" style="min-height: 748px" id="main-content">
                <section class="content-header">
                    <div class="container-fluid">
                        <div class="row mb-2">
                            <div class="col-sm-6">
                                <h1>Profil</h1>
                            </div>
                            <div class="col-sm-6">
                                <ol class="breadcrumb float-sm-right">
                                    <li class="breadcrumb-item active">Profil</li>
                                </ol>
                            </div>
                        </div>
                    </div>
                </section>
                <section class="content">
                    <div class="container-fluid">
                        <div class="row">
                            <div class="col-md-3">
                                <div class="box box-primary">
                                    <div class="box-body box-profile" style="display: flex;
                    flex-direction: column;
                    justify-content: center;
                    align-items: center;">
                                        <i class="bi bi-person-circle" style="font-size: 35px"></i>
                                        <h3 class="profile-username text-center"></h3>
                                        <p class="text-muted text-center" id="text_role"></p>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-9">
                                <section class="content">
                                    <div class="container-fluid">
                                        <div class="row">
                                            <div class="col-md-12">
                                                <div class="card">
                                                    <div class="card-header">
                                                        <h3 class="card-title">
                                                            Informations sur mon profil
                                                        </h3>
                                                    </div>
                                                    <form method="POST">
                                                        <div class="card-body">
                                                            <div class="row">
                                                                <div class="col">
                                                                    <div class="form-group">
                                                                        <label
                                                                            for="exampleInputEmail1">Login</label><input
                                                                            type="text" class="form-control undefined"
                                                                            placeholder="Nom d'utilisateur"
                                                                            name="login" id="login" />
                                                                    </div>
                                                                </div>
                                                                <div class="col">
                                                                    <div class="form-group">
                                                                        <label
                                                                            for="exampleInputEmail1">Prénom</label><input
                                                                            type="text" class="form-control undefined"
                                                                            placeholder="Prénom de l'utilisateur"
                                                                            name="prenom" id="prenom" />
                                                                    </div>
                                                                </div>
                                                            </div>
                                                            <div class="row">
                                                                <div class="col">
                                                                    <div class="form-group">
                                                                        <label
                                                                            for="exampleInputEmail1">Nom</label><input
                                                                            type="text" class="form-control undefined"
                                                                            placeholder="Nom de l'utilisateur"
                                                                            name="nom" id="nom" />
                                                                    </div>
                                                                </div>
                                                                <div class="col">
                                                                    <div class="form-group">
                                                                        <label
                                                                            for="exampleInputEmail1">Email</label><input
                                                                            type="email" class="form-control undefined"
                                                                            placeholder="Entre votre email" name="email"
                                                                            id="email" />
                                                                    </div>
                                                                </div>
                                                            </div>
                                                            <div class="row">
                                                                <div class="col">
                                                                    <div class="form-group">
                                                                        <label
                                                                            for="exampleInputEmail1">Adresse</label><input
                                                                            type="text" class="form-control undefined"
                                                                            placeholder="Entre votre adresse"
                                                                            name="adresse" id="adresse" />
                                                                    </div>
                                                                </div>
                                                                <div class="col">
                                                                    <div class="form-group">
                                                                        <label
                                                                            for="exampleInputEmail1">Téléphone</label><input
                                                                            type="text" class="form-control undefined"
                                                                            placeholder="Entre le numéro de telephone"
                                                                            name="telephone" id="telephone" />
                                                                        <i id="erreurPhone"
                                                                            style="display: None;"><small
                                                                                style="color: rgb(248, 31, 31);">Le
                                                                                numéro de
                                                                                téléphone doit commencer par 0 et avoir
                                                                                10
                                                                                chiffres</small></i>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                            <div id="secteurs" style="display: none;">
                                                                <div class="row">
                                                                    <div class="col">
                                                                        <div class="form-group">
                                                                            <label
                                                                                for="exampleInputEmail1">Secteur Primaire</label><input
                                                                                type="text" class="form-control undefined"
                                                                                placeholder="Secteur primaire"
                                                                                name="primaire" id="primaire" />
                                                                        </div>
                                                                    </div>
                                                                    <div class="col">
                                                                        <div class="form-group">
                                                                            <label
                                                                                for="exampleInputEmail1">Secteur Secondaire</label><input
                                                                                type="text" class="form-control undefined"
                                                                                placeholder="Secteur secondaire" name="secondaire"
                                                                                id="secondaire" />
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                                <div class="row">
                                                                    <div class="col">
                                                                        <div class="form-group">
                                                                            <label for="exampleInputEmail1">Trigramme</label>
                                                                            <input type="text" class="form-control undefined"
                                                                                placeholder="Trigramme" name="trigramme" id="trigramme"
                                                                                readonly="" />
                                                                        </div>
                                                                    </div>
                                                                    
                                                                </div>
                                                            </div>
                                                            

                                                            <div class="form-group">
                                                                <label for="exampleInputEmail1">Role</label>
                                                                <input type="text" class="form-control undefined"
                                                                    placeholder="Rôle" name="type_user" id="type_user"
                                                                    readonly="" />
                                                            </div>
                                                        </div>
                                                        <div class="card-footer">
                                                            <button id="goProfile" style="display: inline;"
                                                                class="btn btn-primary">
                                                                Enregistrer </button>&nbsp;&nbsp;
                                                            <a id="leave" class="btn btn-danger"
                                                                onclick="window.history.go(-1)">
                                                                Annuler
                                                            </a>
                                                        </div>
                                                    </form>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </section>
                            </div>
                        </div>
                    </div>
                </section>
            </div>
            <footer class="main-footer"
                style="max-height: 57px; height: 57px; display: flex; justify-content: space-between;">
                <p><b>Version</b> 2.0.0 <strong>
                        Tous droits réservés. © <span id="copyright_year"></span>
                    </strong></p>
                <a href="https://amexpert.pro/" rel="noopener noreferrer" target="_blank"
                    style="color: black"><b>AMEXPERT</b></a>
            </footer>
        </div>
    </div>

    <script>
        $(document).ready(function () {
            let racine = "http://195.15.218.172"
            let user_id = localStorage.getItem("id_user_logged");
            let role = localStorage.getItem('group');
            let url = ""
            if(role=="Agent secteur" || role=="Agent constat"){
                url = racine+"/agent_app/agent/" +user_id;
            }
            
            if(role=="Administrateur"){
                url = racine+"/admin_app/admin/" +user_id;
            }
            $.ajax({
                type: "GET",
                url:url,
                headers: {
                    "Authorization": "Bearer "+ localStorage.getItem("token")
                },
                success: function (response) {
                    let user = response[0];
                    console.log(user)
                    $("#telephone").val(user.telephone).trigger("change");
                    $("#email").val(user.user.email).trigger("change");
                    $("#nom").val(user.user.nom).trigger("change");
                    $("#prenom").val(user.user.prenom).trigger("change");
                    $("#type_user").val(user.user.group).trigger("change");
                    $("#text_role").html(user.user.group);
                    $("#adresse").val(user.adresse).trigger("change");
                    $("#login").val(user.user.login).trigger("change");
                    if(role=="Agent secteur"){
                        $('#secteurs').css('display','inline')
                        $("#primaire").val(user.secteur_primaire).trigger("change");
                        $("#secondaire").val(user.secteur_secondaire).trigger("change");
                        $("#trigramme").val(user.trigramme).trigger("change");
                    }

                },
                error: function () {
                    
                },
            });

            $("#goProfile").on("click", function (e) {
                e.preventDefault();
                let data = {};
                let url ="";
                if(role=="Agent secteur" || "Agent constat"){
                    data['secteur_primaire'] = $('#primaire').val();
                    data['secteur_secondaire'] = $('#secondaire').val();
                    data['trigramme'] = $('#trigramme').val();
                    data["role"] = 1;
                    url = racine+"/agent_app/agent/" +user_id;
                }
                if(role=="Administrateur"){
                    data["role"] = 3;
                    url = racine+"/admin_app/admin/" +user_id;
                }

                $("#goProfile").html("Enregistrement en cours...");
                data["email"] = $("#email").val();
                data["adresse"] = $("#adresse").val();
                data["prenom"] = $("#prenom").val();
                data["nom"] = $("#nom").val();
                data["login"] = $("#login").val();
                data["telephone"] = $("#telephone").val();

                $.ajax({
                    method: "PUT",
                    url: url,
                    crossDomain: true,
                    dataType: "json",
                    headers: {
                        "Authorization": "Bearer " + localStorage.getItem("token")
                    },
                    data: data,
                    success: () => {
                        $("#goProfile").html("Enregistrer");
                        $.toaster({
                            priority: "success",
                            title: "success",
                            message: "Compte modifier avec success...",
                        });
                    },
                    error: () => {
                        $("#goProfile").html("Enregistrer");
                        $.toaster({
                            priority: "danger",
                            title: "danger",
                            message: "Ooops une erreur s'est produite...",
                        });
                    }

                })
            });

        });

    </script>
     <script src="./../../assets/dist/js/pageLoader.js"></script>
</body>

</html>